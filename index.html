<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./skillsCircle.css">
    <link rel="stylesheet" href="./mobileStyles.css">
    <title>Jayden Lynch</title>
</head>
<body>
    <nav>
        <div>
            <a class="logo">JaydenLynch</a>
            <div class="hamburger" onclick="this.parentElement.classList.toggle('switch')">
                <div class="top line"></div>
                <div class="middle line"></div>
                <div class="bottom line"></div>
            </div>
            <ul>
                <li ><a>Home</a></li>
                <li><a>Skills</a></li>
                <li><a>Projects</a></li>
                <li><a>Contact</a></li>
            </ul>
        </div>
    </nav>
    <header>
        <div class="background"></div>
        <div class="title-container">
            <h1 style="color: var(--lightBlue);">Jayden</h1>
            <h1 style="color: var(--orange);">Lynch</h1>
        </div>
    </header>
    <section class="skills">
        <div>
            <div class="shadow"></div>
            <div class="center-circle">
                <h3 id="skillsText">Skills</h3>
                <div class="rating-circle thin" style="width: 100%;"></div>
                <div class="rating-circle thick" style="width: 80%;"></div>
                <div class="rating-circle middle" style="width: 65%;"></div>
                <div class="rating-circle thin" style="width: 55%;"></div>
            </div>
            <div class="tile-container">
                <div class="tile-shadow"><div class="tile" name="python" onclick="showSkillCompetency(this)"></div></div>
                <div class="tile-shadow" num="2"><div class="tile" name="java" onclick="showSkillCompetency(this)"></div></div>
                <div class="tile-shadow" num="3"><div class="tile" name="html" onclick="showSkillCompetency(this.getAttribute('name'), getComputedStyle(this).backgroundColor)"></div></div>
                <div class="tile-shadow" num="4"><div class="tile" name="js" onclick="showSkillCompetency(this.getAttribute('name'), getComputedStyle(this).backgroundColor)"></div></div>
            </div>
            <div class="tile-container alternate-axis">
                <div class="tile-shadow"><div class="tile" name="php" onclick="showSkillCompetency(this.getAttribute('name'), getComputedStyle(this).backgroundColor)"></div></div>
                <div class="tile-shadow" num="2"><div class="tile" name="c++" onclick="showSkillCompetency(this.getAttribute('name'), getComputedStyle(this).backgroundColor)"></div></div>
                <div class="tile-shadow" num="3"><div class="tile" name="css" onclick="showSkillCompetency(this.getAttribute('name'), getComputedStyle(this).backgroundColor)"></div></div>
                <div class="tile-shadow" num="4"><div class="tile" name="c#" onclick="showSkillCompetency(this.getAttribute('name'), getComputedStyle(this).backgroundColor)"></div></div>
            </div>
        </div>
    </section>
    <script>
        const skillCompetencies = new Map([
            ["python", 30],
            ["c++", 70],
            ["java", 90], 
            ["c#", 90],
            ["html", 100],
            ["css", 100], 
            ["js", 70],
            ["php", 40]
        ]);
        function showSkillCompetency(object){
            var name = object.getAttribute('name');
            var colour = getComputedStyle(object).backgroundColor;
            var oldGradient = getComputedStyle(object).background;
            var value = parseInt(skillCompetencies.get(name));
            document.getElementById("skillsText").innerText = value + "%";
            var newGradient = `conic-gradient(var(--tileColour) ${100 - value}%, ${colour} ${100 - value}%, ${colour} ${value}%)`;
            animatePie(oldGradient, newGradient, 5);
        }
        function changeSkillsAnimState(){
            var containers = document.getElementsByClassName("tile-container");
            for(var container of containers){
                container.classList.toggle("stopAnim");
                for(var child of container.children){
                    child.children[0].classList.toggle("stopAnim");
                }
            }
        }
        function animatePie(prevGradient, newGradient, secs) {
        const ruleName = "pieChartAnim";
        const styleSheetId = "animation-keyframes";
        
        let styleSheet = document.getElementById(styleSheetId);
        if (!styleSheet) {
            styleSheet = document.createElement("style");
            styleSheet.id = styleSheetId;
            document.head.appendChild(styleSheet);
        }

        const ss = styleSheet.sheet;

        // Remove any existing animations
        for (let i = ss.cssRules.length - 1; i >= 0; i--) {
            if (ss.cssRules[i].name === ruleName) {
                ss.deleteRule(i);
            }
        }

        ss.insertRule(`@keyframes ${ruleName} {
                from { background: ${prevGradient}; }
                to { background: ${newGradient}; }
            }`, ss.cssRules.length);

        // Apply the animation to elements with the "rating-circle" class
        for (const el of document.getElementsByClassName("rating-circle")) {
            el.style.animation = `${ruleName} ${secs}s ease-in-out 0 1 normal forwards`;
            console.log(`${ruleName} ${secs}s ease-in-out 0 1 normal forwards`);
        }

        // Debug: Log the computed animation styles
        for (const el of document.getElementsByClassName("rating-circle")) {
            console.log(getComputedStyle(el).animation);
        }
    }

    </script>
</body>
</html>